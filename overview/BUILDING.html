
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>&lt;no title&gt; &#8212; Tizonia 0.22.0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/tizonia_logo_200.gif" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=tizonia&repo=tizonia-openmax-il&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/tizonia/tizonia-openmax-il">
    <img
        alt="https://secure.travis-ci.org/tizonia/tizonia-openmax-il.svg?branch=master"
        src="https://secure.travis-ci.org/tizonia/tizonia-openmax-il.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../manual/manual.html">User Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/development.html">Developer Guide</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://tizonia.org">Tizonia Website</a></li>
    
    <li class="toctree-l1"><a href="https://github.com/tizonia/tizonia-openmax-il">Source (GitHub)</a></li>
    
    <li class="toctree-l1"><a href="https://github.com/tizonia/tizonia-openmax-il/issues">Issues (GitHub)</a></li>
    
    <li class="toctree-l1"><a href="https://bintray.com/tizonia">Binaries (Bintray)</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p># Building from Source (with Autotools)</p>
<p>&lt;!– START doctoc generated TOC please keep comment here to allow auto update –&gt;
&lt;!– DON’T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE –&gt;</p>
<ul>
<li><p>[Prerequisites](#prerequisites)</p></li>
<li><p>[Dependencies](#dependencies)</p></li>
<li><p>[Building](#building)
- [‘Debug’ variant](#debug-variant)
- [‘Release’ variant](#release-variant)
- [Single Debian package created with ‘checkinstall’](#single-debian-package-created-with-checkinstall)
- [The traditional method](#the-traditional-method)
- [Conditional compilation of sub-projects](#conditional-compilation-of-sub-projects)</p>
<blockquote>
<div><ul class="simple">
<li><p>[Excluding the <cite>player</cite> sub-project](#excluding-the-player-sub-project)</p></li>
<li><p>[Excluding the <cite>plugins/spotify_source</cite> sub-project](#excluding-the-pluginsspotify_source-sub-project)</p></li>
<li><p>[Excluding the <cite>plugins/pcm_renderer_alsa</cite> sub-project](#excluding-the-pluginspcm_renderer_alsa-sub-project)</p></li>
</ul>
</div></blockquote>
</li>
<li><p>[Tizonia’s configuration file](#tizonias-configuration-file)</p></li>
<li><p>[Resource Manager’s D-BUS service activation file (optional)](#resource-managers-d-bus-service-activation-file-optional)</p></li>
<li><p>[Known issues](#known-issues)</p></li>
<li><p>[Speeding up (re-)compilation using ccache](#speeding-up-re-compilation-using-ccache)</p></li>
<li><p>[Creating a JSON compilation database, for use with e.g. Emacs RTags](#creating-a-json-compilation-database-for-use-with-eg-emacs-rtags)</p></li>
</ul>
<p>&lt;!– END doctoc generated TOC please keep comment here to allow auto update –&gt;</p>
<p>To build and install from source, please read the following sections. Ubuntu
18.04 is assumed, but should work on other recent Debian-based distros.</p>
<p>### Prerequisites</p>
<p>Please make sure you have enough RAM available on your system to build
Tizonia. A good 8GB of RAM may be needed if you are planning to build
everything, including the ‘tizonia’ player application. You might encounter
problems if you are trying to run the compilation while large programs like
Chrome or Firefox are running. See [Known issues](#known-issues) for the kind
of errors that you might encounter in those cases. Also look at [Conditional
compilation of sub-projects](#conditional-compilation-of-sub-projects) for
instructions on how to disable certain parts of the software.</p>
<p>&gt; NOTE: Also make sure you have some time in your hands. Building Tizonia may
&gt; take at least 20 minutes on a fast SSD-based system. You may want to look at
&gt; [Speeding up (re-)compilation
&gt; usingccache](#speeding-up-re-compilation-using-ccache) if you are planning to
&gt; build the Tizonia tree multiple times.</p>
<p>### Dependencies</p>
<p>To install all the development dependencies, the <cite>tizonia-dev-build</cite> tool is
the recommended way. This script lives under the <cite>tools</cite> directory and internally
maintains an up-to-date list of all the packages that are required in a
Debian-compatible system to build Tizonia from source.</p>
<p>&gt; NOTE: The following command installs Mopidy’s ‘libspotify-dev’ package, and
&gt; the ‘gmusicapi’, ‘soundcloud’, ‘pafy’ and ‘youtube-dl’ Python PIP packages,
&gt; plus a few other necessary debian packages.</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>bash
# Setup the following environment variables
$ export TIZONIA_REPO_DIR=/path/to/tizonia/repo # (e.g. /home/user/tizonia-openmax-il)
$ export TIZONIA_INSTALL_DIR=/path/to/install/dir # (e.g. /usr or /home/user/temp)
$ export PATH=$TIZONIA_REPO_DIR/tools:$PATH</p>
<p># Set the PYTHONPATH accordingly (replace X to match the python version on your system)
$ export PYTHONPATH=$TIZONIA_INSTALL_DIR/lib/python3.X/site-packages:$PYTHONPATH</p>
<p># Now install everything that is required to build Tizonia from source (Debian derivative assumed)
$ tizonia-dev-build –deps
<a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<p>### Building</p>
<p>Once all the dependencies have been installed, build and install the OpenMAX IL
framework, all plugins and the ‘tizonia’ command-line application, using any of
the following methods.</p>
<p>#### ‘Debug’ variant</p>
<p>The following command re-configures all sub-projects with ‘debug’ type of
flags, and then proceeds to build and install them.</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">$</span> <span class="pre">tizonia-dev-build</span> <span class="pre">--debug</span> <span class="pre">--install</span>
<span class="pre">`</span></code></p>
<p>#### ‘Release’ variant</p>
<p>The following command re-configures all sub-projects with ‘release’ type of
flags, builds and installs them.</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">$</span> <span class="pre">tizonia-dev-build</span> <span class="pre">--release</span> <span class="pre">--install</span>
<span class="pre">`</span></code></p>
<p>#### Single Debian package created with ‘checkinstall’</p>
<p>The following command configures all sub-projects with ‘release’ flags
appropriate for a Debian/Ubuntu system, builds the whole repo, then using
[checkinstall](<a class="reference external" href="https://debian-administration.org/article/147/Installing_packages_from_source_code_with_checkinstall">https://debian-administration.org/article/147/Installing_packages_from_source_code_with_checkinstall</a>)
creates a single Debian package and installs it in the system. The package can
then be removed via ‘dpkg’ or even moved to another machine for testing.</p>
<dl class="simple">
<dt>&gt; NOTE: This is the best way to build Tizonia if all you want is to install it</dt><dd><p>on a system that for which there are no official binaries.</p>
</dd>
<dt>&gt; NOTE: This is not how the Debian packages hosted on Bintray are created. The</dt><dd><p>packages hosted on Bintray are fully ‘debianized’ packages created using the
‘tizonia-qemu-debootstrap-env’ script.</p>
</dd>
</dl>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a>bash
# This produces and install a Debian package called ‘tizonia-all-testing’
$ tizonia-dev-build –debian</p>
<p># To remove from the system, run:
$ dpkg -r tizonia-all-testing
<a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a></p>
<p>#### The traditional method</p>
<p>Alternatively, from the top of Tizonia’s repo, one can also do the familiar:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">$</span> <span class="pre">autoreconf</span> <span class="pre">-ifs</span>
<span class="pre">$</span> <span class="pre">./configure</span>&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">or</span> <span class="pre">./configure</span> <span class="pre">--disable-player</span> <span class="pre">to</span> <span class="pre">disable</span> <span class="pre">the</span> <span class="pre">command-line</span> <span class="pre">player</span> <span class="pre">program</span>
<span class="pre">$</span> <span class="pre">make</span>
<span class="pre">$</span> <span class="pre">make</span> <span class="pre">install</span>
<span class="pre">`</span></code></p>
<p>#### Conditional compilation of sub-projects</p>
<p>##### Excluding the <cite>player</cite> sub-project</p>
<p>Some people are only interested in building the OpenMAX IL framework, without
the <cite>tizonia</cite> player application (that lives under the ‘player’
sub-directory). During configuration, it can be disabled by including the
<cite>–disable-player</cite> option:</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">#</span> <span class="pre">Disable</span> <span class="pre">compilation</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">command-line</span> <span class="pre">player</span> <span class="pre">program.</span>
<span class="pre">$</span> <span class="pre">./configure</span> <span class="pre">--disable-player</span>
<span class="pre">`</span></code></p>
<p>Alternatively, the <cite>–no-player</cite> option may be added to <cite>tizonia-dev-build</cite> to
disable configuration and build of the <cite>tizonia</cite> player.</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">#</span> <span class="pre">Build</span> <span class="pre">and</span> <span class="pre">install</span> <span class="pre">in</span> <span class="pre">DEBUG</span> <span class="pre">mode</span> <span class="pre">without</span> <span class="pre">the</span> <span class="pre">command-line</span> <span class="pre">player</span> <span class="pre">program.</span>
<span class="pre">$</span> <span class="pre">tizonia-dev-build</span> <span class="pre">--no-player</span> <span class="pre">--debug</span> <span class="pre">--install</span>
<span class="pre">`</span></code></p>
<p>##### Excluding the <cite>plugins/spotify_source</cite> sub-project</p>
<p>The <cite>–without-libspotify</cite> option may be included to disable configuration and
build of the libspotify-based OpenMAX IL component. This option will also
disable the support for this plugin in the <cite>tizonia</cite> player program.</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">#</span> <span class="pre">Disable</span> <span class="pre">support</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">spotify_source</span> <span class="pre">plugin.</span>
<span class="pre">$</span> <span class="pre">./configure</span> <span class="pre">--without-libspotify</span>
<span class="pre">`</span></code></p>
<p>##### Excluding the <cite>plugins/pcm_renderer_alsa</cite> sub-project</p>
<p>The <cite>–without-alsa</cite> option may be included to disable configuration and
build of the ALSA-based OpenMAX IL pcm renderer.</p>
<p><code class="docutils literal notranslate"><span class="pre">`bash</span>
<span class="pre">#</span> <span class="pre">Disable</span> <span class="pre">support</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">ALSA</span> <span class="pre">pcm</span> <span class="pre">renderer</span> <span class="pre">plugin.</span>
<span class="pre">$</span> <span class="pre">./configure</span> <span class="pre">--without-alsa</span>
<span class="pre">`</span></code></p>
<p>### Tizonia’s configuration file</p>
<p>Copy <em>tizonia.conf</em> into the user’s config folder:</p>
<p><a href="#id17"><span class="problematic" id="id18">``</span></a><a href="#id19"><span class="problematic" id="id20">`</span></a>bash
$ mkdir -p $HOME/.config/tizonia </p>
<blockquote>
<div><p>&amp;&amp; cp $TIZONIA_REPO_DIR/config/src/tizonia.conf $HOME/.config/tizonia</p>
</div></blockquote>
<p><a href="#id21"><span class="problematic" id="id22">``</span></a><a href="#id23"><span class="problematic" id="id24">`</span></a></p>
<p>### Resource Manager’s D-BUS service activation file (optional)</p>
<p>OpenMAX IL Resource Management is present but disabled by default. This is a
feature required on an compliant OpenMAX IL 1.2 implementation. Currently,
there is no other use beyond enabling OpenMAX IL compliance. In case this is to
be used during OpenMAX IL conformance testing (prior to that, it needs to be
explicitly enabled in tizonia.conf), copy the Resource Manager’s D-BUS
activation file to some place where it can be found by the DBUS services. E.g:</p>
<p><a href="#id25"><span class="problematic" id="id26">``</span></a><a href="#id27"><span class="problematic" id="id28">`</span></a>bash
$ mkdir -p ~/.local/share/dbus-1/services </p>
<blockquote>
<div><p>&amp;&amp; cp rm/tizrmd/dbus/com.aratelia.tiz.rm.service ~/.local/share/dbus-1/services</p>
</div></blockquote>
<p><a href="#id29"><span class="problematic" id="id30">``</span></a><a href="#id31"><span class="problematic" id="id32">`</span></a></p>
<p>### Known issues</p>
<p>The <cite>tizonia</cite> player app makes heavy use the the the
[Boost Meta State Machine (MSM)](<a class="reference external" href="http://www.boost.org/doc/libs/1_55_0/libs/msm/doc/HTML/index.html">http://www.boost.org/doc/libs/1_55_0/libs/msm/doc/HTML/index.html</a>)
library by Christophe Henry (MSM is in turn based on
[Boost MPL](<a class="reference external" href="http://www.boost.org/doc/libs/1_56_0/libs/mpl/doc/index.html">http://www.boost.org/doc/libs/1_56_0/libs/mpl/doc/index.html</a>)).</p>
<p>MSM is used to generate a number of state machines that control the tunneled
OpenMAX IL components for the various playback uses cases. The state machines
are quite large and MSM is known for not being easy on the compilers. Building
the <cite>tizonia</cite> command-line app in ‘debug’ configuration (with debug symbols,
etc) requires quite a bit of RAM.</p>
<p>You may see GCC crashing like below; simply keep running <cite>make -j1</cite> or <cite>make
-j1 install</cite> until the application is fully built (it will finish eventually,
given the sufficient amount RAM). An alternative to that is to build in
‘release’ mode (especially if you are on a 32-bit distro).</p>
<p><a href="#id33"><span class="problematic" id="id34">``</span></a><a href="#id35"><span class="problematic" id="id36">`</span></a>bash
Making all in src</p>
<blockquote>
<div><p>CXX      tizonia-tizplayapp.o
CXX      tizonia-main.o
CXX      tizonia-tizomxutil.o
CXX      tizonia-tizprogramopts.o
CXX      tizonia-tizgraphutil.o
CXX      tizonia-tizgraphcback.o
CXX      tizonia-tizprobe.o
CXX      tizonia-tizdaemon.o
CXX      tizonia-tizplaylist.o
CXX      tizonia-tizgraphfactory.o
CXX      tizonia-tizgraphmgrcmd.o
CXX      tizonia-tizgraphmgrops.o
CXX      tizonia-tizgraphmgrfsm.o
CXX      tizonia-tizgraphmgr.o
CXX      tizonia-tizdecgraphmgr.o</p>
</div></blockquote>
<p>g++: internal compiler error: Killed (program cc1plus)
Please submit a full bug report,
with preprocessed source if appropriate.
See &lt;<a class="reference external" href="file:///usr/share/doc/gcc-4.8/README.Bugs">file:///usr/share/doc/gcc-4.8/README.Bugs</a>&gt; for instructions.
make[2]: <strong>* [tizonia-tizplayapp.o] Error 4
make[2]: *</strong> Waiting for unfinished jobs….
g++: internal compiler error: Killed (program cc1plus)
Please submit a full bug report,
with preprocessed source if appropriate.
See &lt;<a class="reference external" href="file:///usr/share/doc/gcc-4.8/README.Bugs">file:///usr/share/doc/gcc-4.8/README.Bugs</a>&gt; for instructions.</p>
<p><a href="#id37"><span class="problematic" id="id38">``</span></a><a href="#id39"><span class="problematic" id="id40">`</span></a></p>
<p>### Speeding up (re-)compilation using ccache</p>
<p>[ccache](<a class="reference external" href="https://ccache.samba.org/">https://ccache.samba.org/</a>) is a compiler cache. It speeds up
recompilation by caching previous compilations. With Tizonia, this is very
useful during development, especially since the ‘player’ application is so hard
to build due to the boost machinery.</p>
<p>On a debian system, ccache can be installed using:</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">$</span> <span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">ccache</span>
<span class="pre">`</span></code></p>
<p>Once ccache is installed, <cite>tizonia-dev-build</cite> will detect its presence and
start making use of it to (dramatically) reduce compilation time in most cases.</p>
<p>### Creating a JSON compilation database, for use with e.g. Emacs RTags</p>
<p>JSON compilation databases are used nowdays by many tools to provide
information on how a single compilation unit is processed. This helps these
programs to perform many useful tasks, like static analyses of various
kinds. [RTags](<a class="reference external" href="https://github.com/Andersbakken/rtags">https://github.com/Andersbakken/rtags</a>) is an example of program
that uses a JSON compilation database to index C/C++ code and keep a persistent
file-based database, for use within Emacs to provide powerful integrations.</p>
<p><cite>tizonia-dev-build</cite> has support for <cite>bear</cite> (a program that creates JSON
databases) and RTags. To use, install both programs:</p>
<p><a href="#id41"><span class="problematic" id="id42">``</span></a>`
$ sudo apt-get install bear</p>
<p># For RTags, visit its GitHub for up-to-date installation instructions
# <a class="reference external" href="https://github.com/Andersbakken/rtags">https://github.com/Andersbakken/rtags</a></p>
<p><a href="#id43"><span class="problematic" id="id44">``</span></a><a href="#id45"><span class="problematic" id="id46">`</span></a></p>
<p>and finally, create the compilation db with these two commands:</p>
<p><a href="#id47"><span class="problematic" id="id48">``</span></a>`
$ tizonia-dev-build –debug (or –release)</p>
<p># followed by</p>
<p>$ tizonia-dev-build –bear
<a href="#id49"><span class="problematic" id="id50">``</span></a><a href="#id51"><span class="problematic" id="id52">`</span></a></p>
<p>After that, to keep the database up-to-date after code changes, use:</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">$</span> <span class="pre">tizonia-dev-build</span> <span class="pre">--make</span> <span class="pre">(or</span> <span class="pre">--install)</span>
<span class="pre">`</span></code></p>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2020, Juan A. Rubio and contributors.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/overview/BUILDING.md.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/tizonia/tizonia-openmax-il" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-21817639-6']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    
  </body>
</html>